# Implementation Plan

- [x] 1. プロジェクト構造とインフラストラクチャのセットアップ





  - AWS CDKプロジェクトを初期化し、TypeScript設定を構成する
  - S3バケット（入力用・出力用）、DynamoDBテーブル、IAMロールを定義するCDKスタックを作成する
  - 開発環境用の環境変数とシークレット管理の仕組みを実装する
  - _Requirements: 3.1, 3.2_

- [x] 2. DynamoDBデータモデルとアクセスレイヤーの実装




  - [x] 2.1 DynamoDBスキーマとインデックスを定義する


    - MeetingJobsテーブルのスキーマをCDKで定義する
    - GSI（userId-createdAt-index）を作成する
    - _Requirements: 3.2, 6.4_
  
  - [x] 2.2 データアクセスレイヤーを実装する


    - ジョブのCRUD操作を行うリポジトリクラスを作成する
    - ジョブステータス更新、ジョブ一覧取得のメソッドを実装する
    - エラーハンドリングとログ記録を追加する
    - ユニットテストを作成する
    - _Requirements: 6.1, 6.2, 6.3_

- [x] 3. ファイルアップロード機能の実装




  - [x] 3.1 アップロード用Lambda関数を作成する


    - Presigned URL生成ロジックを実装する
    - ファイルバリデーション（形式、サイズ、MIMEタイプ）を実装する
    - DynamoDBにジョブレコードを作成する処理を実装する
    - エラーハンドリングとCloudWatchログ記録を追加する
    - ユニットテストを作成する
    - _Requirements: 1.1, 1.4, 3.2, 6.1, 6.2_
  
  - [x] 3.2 API Gatewayエンドポイントを設定する


    - POST /api/uploadエンドポイントをCDKで定義する
    - CORS設定を追加する
    - Lambda統合を設定する
    - _Requirements: 3.1_

- [x] 4. AWS Transcribe統合の実装




  - [x] 4.1 Transcribe起動Lambda関数を作成する


    - AWS Transcribeジョブを開始するロジックを実装する
    - 話者識別（Speaker Diarization）を有効化する
    - ジョブ名とS3パスを適切に設定する
    - エラーハンドリングを実装する
    - ユニットテストを作成する
    - _Requirements: 1.2, 1.5, 3.3_
  

  - [x] 4.2 Transcribeステータス確認Lambda関数を作成する

    - Transcribeジョブのステータスをポーリングするロジックを実装する
    - 完了、失敗、進行中の各状態を処理する
    - DynamoDBのステータスを更新する
    - ユニットテストを作成する
    - _Requirements: 1.3, 6.4_

- [ ] 5. Step Functionsワークフローの実装
  - ワークフローのステートマシン定義をCDKで作成する
  - TranscribeVideo、WaitForTranscription、CheckTranscriptionStatus、GenerateMinutesの各ステートを定義する
  - エラーハンドリングとリトライポリシーを設定する
  - CloudWatchログ統合を設定する
  - _Requirements: 3.4, 6.1, 6.3_

- [ ] 6. 議事録生成機能の実装
  - [ ] 6.1 文字起こし結果の解析処理を実装する
    - S3からTranscribe出力（JSON）を取得する処理を実装する
    - JSONをパースして話者情報とタイムスタンプ付きテキストを抽出する
    - 整形されたテキストを生成する
    - ユニットテストを作成する
    - _Requirements: 1.3, 1.5_
  
  - [ ] 6.2 Amazon Bedrock統合を実装する
    - Bedrock APIクライアントを設定する
    - 議事録生成用のプロンプトテンプレートを作成する
    - LLMを呼び出して構造化された議事録を生成する処理を実装する
    - レスポンスをパースしてMinutesオブジェクトに変換する
    - エラーハンドリングとリトライロジックを実装する
    - ユニットテストを作成する
    - _Requirements: 2.1, 2.2, 2.3, 2.4_
  
  - [ ] 6.3 議事録保存Lambda関数を作成する
    - 生成された議事録をMarkdown形式でS3に保存する
    - DynamoDBのジョブステータスを'COMPLETED'に更新する
    - メタデータ（生成日時、ファイルパス）を記録する
    - エラーハンドリングを実装する
    - ユニットテストを作成する
    - _Requirements: 2.5, 7.1, 7.2, 7.4_

- [ ] 7. ジョブステータス取得APIの実装
  - [ ] 7.1 ステータス取得Lambda関数を作成する
    - DynamoDBから指定されたジョブIDの情報を取得する
    - ジョブが存在しない場合の404エラーハンドリングを実装する
    - レスポンス形式を定義して返す
    - ユニットテストを作成する
    - _Requirements: 6.2, 6.4_
  
  - [ ] 7.2 ジョブ一覧取得Lambda関数を作成する
    - userIdでフィルタリングしてジョブ一覧を取得する
    - ページネーション機能を実装する
    - 作成日時の降順でソートする
    - ユニットテストを作成する
    - _Requirements: 7.6_
  
  - [ ] 7.3 API Gatewayエンドポイントを設定する
    - GET /api/jobsエンドポイントを定義する
    - GET /api/jobs/{jobId}エンドポイントを定義する
    - Lambda統合を設定する
    - _Requirements: 3.1_

- [ ] 8. 議事録取得とダウンロード機能の実装
  - [ ] 8.1 議事録取得Lambda関数を作成する
    - S3から議事録ファイル（Markdown）を取得する
    - JSONレスポンスとして議事録内容を返す
    - エラーハンドリングを実装する
    - ユニットテストを作成する
    - _Requirements: 7.2, 7.5_
  
  - [ ] 8.2 ダウンロードURL生成Lambda関数を作成する
    - Markdown形式のPresigned URLを生成する
    - PDF変換が要求された場合の処理を実装する（PDF生成ライブラリを使用）
    - 複数フォーマット対応を実装する
    - ユニットテストを作成する
    - _Requirements: 7.3, 7.5_
  
  - [ ] 8.3 API Gatewayエンドポイントを設定する
    - GET /api/jobs/{jobId}/minutesエンドポイントを定義する
    - GET /api/jobs/{jobId}/downloadエンドポイントを定義する
    - Lambda統合を設定する
    - _Requirements: 3.1, 7.7_

- [ ] 9. フロントエンドプロジェクトのセットアップ
  - Next.js 14プロジェクトを作成する（App Router使用）
  - TypeScript、TailwindCSS、必要な依存関係をインストールする
  - API通信用のクライアントライブラリを設定する
  - 環境変数設定（API Gateway URL）を構成する
  - _Requirements: 7.1_

- [ ] 10. ファイルアップロードUIの実装
  - [ ] 10.1 アップロードページコンポーネントを作成する
    - ドラッグ&ドロップエリアを実装する
    - ファイル選択ボタンを実装する
    - ファイルバリデーション（クライアント側）を実装する
    - アップロード進捗バーを実装する
    - _Requirements: 7.2, 7.3_
  
  - [ ] 10.2 アップロード処理ロジックを実装する
    - API呼び出しでPresigned URLを取得する
    - S3への直接アップロードを実装する
    - アップロード完了後にジョブ詳細ページへリダイレクトする
    - エラーハンドリングとトースト通知を実装する
    - _Requirements: 7.2, 7.3_

- [ ] 11. ジョブ一覧・詳細UIの実装
  - [ ] 11.1 ジョブ一覧ページを作成する
    - ジョブ一覧を取得して表示するコンポーネントを実装する
    - 各ジョブのステータス、作成日時、ファイル名を表示する
    - ジョブ詳細ページへのリンクを実装する
    - ページネーション機能を実装する
    - _Requirements: 7.6_
  
  - [ ] 11.2 ジョブ詳細ページを作成する
    - ジョブステータスを表示するコンポーネントを実装する
    - リアルタイム進捗表示（ポーリング）を実装する
    - 処理中のステータスインジケーターを実装する
    - エラー表示機能を実装する
    - _Requirements: 7.3, 7.4_

- [ ] 12. 議事録表示・編集UIの実装
  - [ ] 12.1 議事録プレビューコンポーネントを作成する
    - 概要、決定事項、ネクストアクションをセクション分けして表示する
    - Markdownレンダリングを実装する
    - 文字起こし全文の表示/非表示トグルを実装する
    - _Requirements: 7.4, 7.5_
  
  - [ ] 12.2 議事録編集機能を実装する
    - 各セクションの編集可能なテキストエリアを実装する
    - 保存ボタンとAPI呼び出しを実装する
    - 編集中の状態管理を実装する
    - 変更の保存確認ダイアログを実装する
    - _Requirements: 7.5_
  
  - [ ] 12.3 ダウンロード機能を実装する
    - ダウンロードボタンを実装する
    - フォーマット選択（Markdown、PDF、テキスト）を実装する
    - ダウンロードURL取得とファイルダウンロードを実装する
    - _Requirements: 7.7, 7.5_

- [ ] 13. レスポンシブデザインの実装
  - モバイルデバイス向けのレイアウト調整を実装する
  - タブレット向けのレイアウト調整を実装する
  - タッチ操作に対応したUIコンポーネントを実装する
  - ブレークポイントごとのスタイリングをTailwindCSSで実装する
  - _Requirements: 7.8_

- [ ] 14. 認証機能の実装（オプション）
  - Amazon Cognitoユーザープールを作成する
  - サインアップ・ログインページを実装する
  - JWTトークン管理を実装する
  - 認証済みユーザーのみアクセス可能にする保護ルートを実装する
  - _Requirements: 3.6_

- [ ] 15. エラーハンドリングとログの統合
  - [ ] 15.1 統一されたエラーハンドリングを実装する
    - すべてのLambda関数に共通のエラーハンドリングミドルウェアを追加する
    - ユーザーフレンドリーなエラーメッセージマッピングを実装する
    - エラー分類（4xx、5xx）を実装する
    - _Requirements: 6.1, 6.2_
  
  - [ ] 15.2 CloudWatchログ統合を実装する
    - 構造化ログフォーマットを定義する
    - すべての処理ステップでログを記録する
    - カスタムメトリクスを実装する（処理時間、成功率）
    - _Requirements: 6.3, 6.4_

- [ ] 16. 統合テストの作成
  - [ ] 16.1 API統合テストを作成する
    - アップロードからダウンロードまでのエンドツーエンドフローをテストする
    - エラーケース（無効なファイル、存在しないジョブ）をテストする
    - 並行処理のテストを作成する
    - _Requirements: 1.1, 1.4, 2.1, 6.2_
  
  - [ ] 16.2 Step Functionsワークフローテストを作成する
    - 正常系のワークフロー実行をテストする
    - エラーハンドリングとリトライをテストする
    - タイムアウトケースをテストする
    - _Requirements: 3.4, 6.1_

- [ ] 17. フロントエンドE2Eテストの作成
  - Playwrightテスト環境をセットアップする
  - ファイルアップロードフローのE2Eテストを作成する
  - ジョブ一覧・詳細表示のE2Eテストを作成する
  - 議事録表示・編集・ダウンロードのE2Eテストを作成する
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5, 7.7_

- [ ] 18. デプロイメントパイプラインの構築
  - GitHub ActionsまたはAWS CodePipelineの設定ファイルを作成する
  - ビルド、テスト、デプロイのステージを定義する
  - ステージング環境と本番環境の分離を実装する
  - デプロイ前のE2Eテスト実行を設定する
  - _Requirements: 3.1, 3.5_

- [ ] 19. モニタリングとアラートの設定
  - CloudWatchダッシュボードを作成する
  - エラー率のアラームを設定する
  - レイテンシのアラームを設定する
  - X-Ray分散トレーシングを有効化する
  - _Requirements: 6.3_

- [ ] 20. ドキュメントとREADMEの作成
  - プロジェクトREADMEを作成する（セットアップ手順、使用方法）
  - API仕様書を作成する
  - デプロイメントガイドを作成する
  - トラブルシューティングガイドを作成する
  - _Requirements: すべての要件_
